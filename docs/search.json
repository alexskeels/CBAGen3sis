[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Center for Biodiversity Analysis: Gen3sis Workshop 2024",
    "section": "",
    "text": "Program"
  },
  {
    "objectID": "index.html#day-1",
    "href": "index.html#day-1",
    "title": "Center for Biodiversity Analysis: Gen3sis Workshop 2024",
    "section": "Day 1",
    "text": "Day 1\n\n\n\n\n\n\n\nTime\nEvent\n\n\n\n\n09:00 - 09:45\n👋 Welcome (Platypus Room) - Coffee, introductions, and overview of Gen3sis workshop\n\n\n09:45 - 10:45\n🎓 Lecture 1 - Oskar Hagen (Eucalyptus Room): History and philosophy of simulation modelling in biodiversity studies\n\n\n10:45 - 11:00\n☕ Coffee Break\n\n\n11:00 - 12:00\n🛠️ Practical 1 - Gettin’ Started: Installation and Set Up\n\n\n12:00 - 12:30\n🛠️ Practical 2 - Configure Skating: Gen3sis Config Basics\n\n\n12:30 - 13:30\n🍽️ Lunch Break\n\n\n13:30 - 15:30\n🛠️ Practical 2 - Configure Skating: Gen3sis Config Basics (contd.)\n\n\n15:30 - 15:45\n☕ Coffee Break\n\n\n15:45 - 16:30\n🏝️ Practical 3 - Island Hopping: Explore a model island system\n\n\n16:30 - 17:00\n❓ Questions / Wrap up Day 1"
  },
  {
    "objectID": "index.html#day-2",
    "href": "index.html#day-2",
    "title": "Center for Biodiversity Analysis: Gen3sis Workshop 2024",
    "section": "Day 2",
    "text": "Day 2\n\n\n\n\n\n\n\nTime\nEvent\n\n\n\n\n09:00 - 10:00\n🎓 Lecture 2 - Alex and Oskar (Platypus Room): Inference from simulated biodiversity data\n\n\n10:00 - 10:30\n🌍 Practical 4.1 - Silicodiversity: Gen3sis outputs and patterns\n\n\n10:30 - 10:45\n☕ Coffee Break\n\n\n10:45 - 12:30\n🌍 Practical 4.2 - Silicodiversity: Gen3sis outputs and patterns (contd.)\n\n\n12:30 - 13:30\n🍽️ Lunch Break\n\n\n13:30 - 14:15\n🎓 Lecture 3 - Tristan Salles (Platypus Room): Paleoenvironmental models and data\n\n\n14:15 - 14:45\n💬 Discussion\n\n\n14:45 - 15:00\n☕ Coffee Break\n\n\n15:00 - 16:30\n🌍 Practical 5 - Creating Worlds: Modifying landscapes as inputs for Gen3sis\n\n\n16:30 - 17:00\n❓ Questions / Wrap up Day 2"
  },
  {
    "objectID": "index.html#day-3",
    "href": "index.html#day-3",
    "title": "Center for Biodiversity Analysis: Gen3sis Workshop 2024",
    "section": "Day 3",
    "text": "Day 3\n\n\n\n\n\n\n\nTime\nEvent\n\n\n\n\n09:00 - 10:00\n🎓 Lecture 4 - Alex and Oskar: Designing simulation experiments with Gen3sis\n\n\n10:00 - 10:30\n🛠️ Practical 6 - Sandbox: Implementing models in Gen3sis with friends\n\n\n10:30 - 10:45\n☕ Coffee Break\n\n\n10:45 - 12:30\n🛠️ Practical 6 - Sandbox: Implementing models in Gen3sis with friends (contd.)\n\n\n12:30 - 13:30\n🍽️ Lunch Break\n\n\n13:30 - 14:45\n🛠️ Wrapping up Sandbox\n\n\n14:45 - 15:00\n☕ Coffee Break\n\n\n15:00 - 16:00\n🎤 Presenting Sandbox models / Wrap up Day 3\n\n\n16:00 - 16:10\n📝 Feedback session - Gathering final thoughts and suggestions\n\n\n16:10\n🍻 Pub!"
  },
  {
    "objectID": "Day1_Prac1_setup.html#download-workshop-files-github-repository",
    "href": "Day1_Prac1_setup.html#download-workshop-files-github-repository",
    "title": "1  🍍 Gettin’ Started",
    "section": "",
    "text": "Go to https://github.com/alexskeels/CBAGen3sis.github.io and download the repository as follows:\n\n\n\nGithub\n\n\nPut it somewhere on your machine that you can readily access\nUnzip the folder\nOpen up RStudio\nSet the working directory to this folder using here package.\n\nif (!require(\"here\")) {\n  install.packages(\"here\")\n}\nlibrary(here)\n#setwd(file.path(\"WHERE/YOU/UNZIPPED\",\"CBAGen3sis.github.io\"))",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>🍍 Gettin' Started</span>"
    ]
  },
  {
    "objectID": "Day1_Prac1_setup.html#install-packages",
    "href": "Day1_Prac1_setup.html#install-packages",
    "title": "1  🍍 Gettin’ Started",
    "section": "Install Packages",
    "text": "Install Packages\nToday we’ll install the stable version of the package directly from CRAN as follows.\n\n# install the package\ninstall.packages(\"gen3sis\")\n\n# check the package version, we are on 1.5.11\npackageVersion(\"gen3sis\")\n\nYou could also install the most recent version of the package from GitHub using devtools. But hold off on this today so we’re all working with the same version.\n\n#install.packages(\"devtools\")\n#devtools::install_github(repo = \"project-gen3sis/R-package\", dependencies = TRUE)\n#packageVersion(\"gen3sis\")\n\nload gen3sis\nNow, lets source our support functions, to load some of the functions we’ll be going throughout the workshop. The first one is just a convenient way of installing packages if they are not already installed.\nYou can also install these other packages we’ll use throughout the workshop.\n\n\n[1] TRUE TRUE TRUE TRUE TRUE TRUE",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>🍍 Gettin' Started</span>"
    ]
  },
  {
    "objectID": "Day1_Prac1_setup.html#access-data",
    "href": "Day1_Prac1_setup.html#access-data",
    "title": "1  🍍 Gettin’ Started",
    "section": "Access Data",
    "text": "Access Data\nAll the data for the workshop is stored in the ‘data’ folder, for your convenience, we set the paths to the variable data_dir (and others) on our support.R file\n\nsource(\"support.R\")\n\nIn this folder we include a paleoenvironmental reconstruction of South American temperature and aridity at a coarse spatial resolution of 2 degrees, and at a temporal resolution of 1 million years. This is a very rough temporal resolution but should do for our tutorial. Load it in and investigate some of it’s features.\n\n# read the R data file\nlandscape &lt;- readRDS(file.path(\"data\",\"landscapes\", \"SA_coarse\", \"landscapes.rds\"))\n\n# class\nclass(landscape)\n\n[1] \"list\"\n\n# names\nnames(landscape)\n\n[1] \"temp\" \"arid\" \"area\"\n\n# dimensions\ndim(landscape$temp)\n\n[1] 1476   68\n\n# take a look at first elements\nlandscape$temp[1:10, 1:10]\n\n     x  y        1        2        3        4        5        6        7\n1  -94 12       NA       NA       NA       NA       NA       NA       NA\n2  -92 12       NA       NA       NA       NA       NA       NA       NA\n3  -90 12       NA       NA       NA       NA       NA       NA       NA\n4  -88 12       NA       NA       NA       NA       NA       NA 27.97588\n5  -86 12 22.76293 28.90419 28.61839 28.47647 28.00591 27.22872 26.96520\n6  -84 12 23.40779 29.34289 28.68802 28.96432 28.39244 27.69988 27.31383\n7  -82 12       NA       NA       NA       NA       NA       NA       NA\n8  -80 12       NA       NA       NA       NA       NA       NA       NA\n9  -78 12       NA       NA       NA       NA       NA       NA       NA\n10 -76 12       NA       NA       NA       NA       NA       NA       NA\n          8\n1        NA\n2        NA\n3        NA\n4  27.87671\n5  27.05735\n6  27.95244\n7        NA\n8        NA\n9        NA\n10       NA\n\n# column names\ncolnames(landscape$temp)\n\n [1] \"x\"  \"y\"  \"1\"  \"2\"  \"3\"  \"4\"  \"5\"  \"6\"  \"7\"  \"8\"  \"9\"  \"10\" \"11\" \"12\" \"13\"\n[16] \"14\" \"15\" \"16\" \"17\" \"18\" \"19\" \"20\" \"21\" \"22\" \"23\" \"24\" \"25\" \"26\" \"27\" \"28\"\n[31] \"29\" \"30\" \"31\" \"32\" \"33\" \"34\" \"35\" \"36\" \"37\" \"38\" \"39\" \"40\" \"41\" \"42\" \"43\"\n[46] \"44\" \"45\" \"46\" \"47\" \"48\" \"49\" \"50\" \"51\" \"52\" \"53\" \"54\" \"55\" \"56\" \"57\" \"58\"\n[61] \"59\" \"60\" \"61\" \"62\" \"63\" \"64\" \"65\" \"66\"\n\n\nCoolies. We can use different spatial R packages to play with our data, and later on, with our simulated output.\n\n# Present Day South America\nSA_1 &lt;- rast(landscape$temp[ ,c(\"x\", \"y\", \"1\")])\nSA_65 &lt;- rast(landscape$temp[,c(\"x\", \"y\", \"65\")])\n\n# plot present day\nplot(SA_1)\n\n\n\n\n\n\n\n\n\n# plot 65 Million years ago\nplot(SA_65)\n\n\n\n\n\n\n\n\nLets overlay the maps to get an idea of how much South America has changed since the dinosaurs went extinct.\n\n# overlay\nplot(SA_65, col=rgb(1,0,0))\nplot(SA_1, col=rgb(0,0,1,0.5,1), add=T)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>🍍 Gettin' Started</span>"
    ]
  },
  {
    "objectID": "Day1_Prac1_setup.html#access-configs",
    "href": "Day1_Prac1_setup.html#access-configs",
    "title": "1  🍍 Gettin’ Started",
    "section": "Access Configs",
    "text": "Access Configs\nLoad in a config file containing the rules and parameters of a single simulation. We’ll get into what this all means in the next chapter.\n\nconfig &lt;- create_input_config(config_file = file.path(\"configs\", \"config_southamerica_Day1Prac1.R\"))\nnames(config$gen3sis)\n\n[1] \"general\"        \"initialization\" \"dispersal\"      \"speciation\"    \n[5] \"mutation\"       \"ecology\"       \n\nnames(config$gen3sis$general)\n\n[1] \"random_seed\"                      \"start_time\"                      \n[3] \"end_time\"                         \"max_number_of_species\"           \n[5] \"max_number_of_coexisting_species\" \"end_of_timestep_observer\"        \n[7] \"trait_names\"                      \"environmental_ranges\"            \n[9] \"verbose\"",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>🍍 Gettin' Started</span>"
    ]
  },
  {
    "objectID": "Day1_Prac1_setup.html#run-a-single-simulation",
    "href": "Day1_Prac1_setup.html#run-a-single-simulation",
    "title": "1  🍍 Gettin’ Started",
    "section": "Run a Single Simulation",
    "text": "Run a Single Simulation\nNow time to run a simulation in South America. We’ll just run from 20 million years ago to the present-day at 1 million year intervals so it runs quick enough to finish in a couple of minutes. Note the output as it runs. Think about what its printing.\n\nsim &lt;- run_simulation(config = file.path(\"configs\", \"config_southamerica_Day1Prac1.R\"), \n               landscape = file.path(data_dir,\"landscapes\", \"SA_coarse\"),\n               output_directory = \"output/SouthAmerica\",\n               verbose=1)\n\nNow read in some of the outputs.\n\n# read phylogeny\nphy &lt;- read.nexus(file.path(\"output\", \"SouthAmerica\", \"config_southamerica_Day1Prac1\", \"phy.nex\" ))\n\n# plot phylogeny\nplot(phy, cex=0.1, type=\"fan\")\n\n\n\n\n\n\n\n\nIf you’ve made it this far, great! You’re equipped with the tools, now we’re ready to explore how Gen3sis works in more detail.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>🍍 Gettin' Started</span>"
    ]
  },
  {
    "objectID": "Day1_Prac2_basics.html#general",
    "href": "Day1_Prac2_basics.html#general",
    "title": "2  ⛸️ Configure Skating",
    "section": "General",
    "text": "General\nThe first element, ‘general’, sets up some important global parameters of the model\n\nconfig$gen3sis$general\n\n$random_seed\n[1] NA\n\n$start_time\n[1] NA\n\n$end_time\n[1] NA\n\n$max_number_of_species\n[1] NA\n\n$max_number_of_coexisting_species\n[1] NA\n\n$end_of_timestep_observer\nfunction (...) \n{\n}\n&lt;bytecode: 0x0000028539784ae8&gt;\n&lt;environment: 0x0000028539785338&gt;\n\n$trait_names\nlist()\n\n$environmental_ranges\nlist()\n\n$verbose\n[1] FALSE\n\n\nThe random seed determines the starting point for random number generators in R. Because the simulations have stochastic processes, to reproduce a result, we need to have the same random seed, so by fixing it in a simulation, we can ensure we will get the exact same results next time we run the sim. Let’s change the seed to 777.\n\nconfig$gen3sis$general$random_seed\n\n[1] NA\n\nconfig$gen3sis$general$random_seed &lt;- 777\n\nThe start time is the time-step of the landscape file which the simulation will start at. We saw in the previous chapter that the South American landscape file had 65 time-steps, but we actually only started our simulation at time-step 20, or 20 time-steps before the final one. Each time-step in the landscape is 1 million years apart, so the timestep 20 is 20 million years ago. However, if the landscape units were in 100 thousand years, then time-step 20 would be 2 million years ago. Let’s run the next simulation from an older timepoint, lets say the start of the Oligocene, 34 Ma.\n\nconfig$gen3sis$general$start_time\n\n[1] NA\n\nconfig$gen3sis$general$start_time &lt;- 34\n\nOur simulation ran from 20 Ma to the present-day. However, we may wish for the simulation to finish before the present-day, for example just the Oligocene period 34Ma - 23Ma. To do this we can change the ‘end_time’. When left as NA, the simulation will run to the final time-step. So let’s change that to 23 Ma.\n\nconfig$gen3sis$general$end_time\n\n[1] NA\n\nconfig$gen3sis$general$end_time &lt;- 23\n\nOther general settings include setting the maximum number of species in simulation, and in each grid cell before the simulation terminates (max_number_of_species, max_number_of_coexisting_species) which is a good way of aborting simulations before they get unwieldy, the names of the traits that each species will have in the simulation (trait_names), and the range of the environmental data (environmental_ranges). We’ll these as is for now.\n\nconfig$gen3sis$general$max_number_of_species\n\n[1] NA\n\nconfig$gen3sis$general$max_number_of_coexisting_species\n\n[1] NA\n\nconfig$gen3sis$general$trait_names\n\nlist()\n\nconfig$gen3sis$general$environmental_ranges\n\nlist()\n\n\nLast but not least in the general setting is the oberserver function. At each time step in the simulation, users have the option to save different outputs and make different plots. The species object contains a list, where each element is a species. The species has information on the occupancy, abundance, and trait values of populations of that species in all inhabited grid cells. The phylogeny object contains information on the relatedness of all species to each other.\nMost of the biodiversity infromation we simulate is contained in species objects and phylogeny objects so we will save these at each timestep. We will also plot species richness as a way of visualizing how the simulation proceeds.\n\nconfig$gen3sis$general$end_of_timestep_observer = function(data, vars, config){\n    save_species()\n    save_phylogeny()\n  \n  # plotting function example:\n    plot_richness(data$all_species, data$landscape)\n}"
  },
  {
    "objectID": "Day1_Prac2_basics.html#initialization",
    "href": "Day1_Prac2_basics.html#initialization",
    "title": "2  ⛸️ Configure Skating",
    "section": "Initialization",
    "text": "Initialization\nInitialization lets us define the number, abundance, location, and traits of the ancestral species. This is what you start the simulation with. You may want to start with a single species, so the simulation follows the diversification of single monophyletic radiation. Alternatively, you may seed the landscape with many species and this is also possible. Each species must be given the locations in which they will occur, in the form of characters matching the grid cell identifiers, and values for the traits we named in the general settings.\n\nconfig$gen3sis$initialization\n\n$initial_abundance\nNULL\n\n$create_ancestor_species\nNULL\n\n\nIn this example, we are generating five species to begin. We first define a box from which we sample points to use to place the first species on the landscape. We randomly sample a single grid cell to place each initial species in. Next, we give each initial species values for the three traits. Here, we give the value for temp as the temperature value of the grid cell the species will occur in. We set a dispersal equal to 1. We repeat this 5 times, for 5 species. We can create more ancestor species by repeating this process in a loop , or we could manually create ancestral range by hand-selecting grid cells for the species to occur in."
  },
  {
    "objectID": "Day1_Prac2_basics.html#dispersal-migration",
    "href": "Day1_Prac2_basics.html#dispersal-migration",
    "title": "2  ⛸️ Configure Skating",
    "section": "Dispersal (migration)",
    "text": "Dispersal (migration)\nHow species disperse across the landscape is determined by simulated migration events between habitable cells. The range and behaviour of these events is set by users and can be based on fixed values, draws from probability distributions, species trait values, or anything else thought up by users.\n\nconfig$gen3sis$dispersal\n\n$max_dispersal\n[1] Inf\n\n$get_dispersal_values\nNULL\n\n\nHere we set the maximum dispersal distance as infinty (e.g., no maximum), and we draw the dispersal values from a Weibull distribution with shape parameter = 1.5 and scale = 133. We can see what this distribution looks like by plotting a histogram.\n\nhist(rweibull(1000, 1.5, 133), main= \"Weibull Distribution 1\", xlab=\"Dispersal Distance (km)\")\n\n\n\n\nYou can see the dispersal kernel is skewed around the scale parameter (here scale =133), so most dispersal is over shorter distances but some dispersal will be over a longer distance. You can play with the parameters to change the dispersal kernel. These could be based on a trait of the species.\n\n#more skewed distribution\nhist(rweibull(1000, 0.5, 133), main= \"Weibull Distribution 2\", xlab=\"Dispersal Distance (km)\")\n\n\n\n\n\n#less skewed distribution\nhist(rweibull(1000, 3, 133), main= \"Weibull Distribution 2\", xlab=\"Dispersal Distance (km)\")"
  },
  {
    "objectID": "Day1_Prac2_basics.html#speciation-population-divergence",
    "href": "Day1_Prac2_basics.html#speciation-population-divergence",
    "title": "2  ⛸️ Configure Skating",
    "section": "Speciation (population divergence)",
    "text": "Speciation (population divergence)\nIn the speciation function, we determine how populations diverge from one another and when they are sufficiently divergent to become new species. Populations that are geographically isolated (allopatric) diverge at each time step by the divergence factor and are considered new species when the accumulated divergence is greater than the divergence threshold. Divergence decreases when they come back into secondary contact at a rate of 1 and will coalesce into the same population once divergence is equal to 0.\n\nconfig$gen3sis$speciation\n\n$divergence_threshold\nNULL\n\n$get_divergence_factor\nNULL\n\n\nIn this example, the get_divergence_funtion returns a value of 1 each timestep, so the divergence accumulates by a value of 1 at each time step and populations become new species when divergence is greater than the divergence threshold, here given a value of 2. So a new species can form if two populations has been isolated for two timesteps.\nWe can change either the amount of divergence required for speciation…\n\nconfig$gen3sis$speciation$divergence_threshold &lt;- 4\n\n…or the rate at which divergence accumulates.\n\nconfig$gen3sis$speciation$get_divergence_factor &lt;- function(species, cluster_indices, landscape, config) { return(2)}\n\nBoth of these will speed up the rate of speciation, given enough population fragmentation."
  },
  {
    "objectID": "Day1_Prac2_basics.html#mutation-trait-evolution",
    "href": "Day1_Prac2_basics.html#mutation-trait-evolution",
    "title": "2  ⛸️ Configure Skating",
    "section": "Mutation (trait evolution)",
    "text": "Mutation (trait evolution)\nIn the evolution function, we determine how the species’ traits change at each timestep and therefore how they evolve over time. In gen3sis, each species is comprised of separate populations in each inhabited grid cell, these populations form geographic clusters that are within dispersal distance of one another and could be considered to exchange individuals, and all geographic clusters together comprise the species.\nWe can evolve traits of each population independently. Alternatively, we could give all populations within a geographic cluster shared trait values and evolve traits at this level of organization, or again at the whole species level. At which level of biological organization you evolve traits will depend on your hypothesis and the system you are trying to represent.\nIn addition to mutating the traits of species, we might also want to homogenise traits of populations that are likely exchanging gene flow.\nThis example, highlights both homogenising traits and evolving traits.\n\nconfig$gen3sis$mutation\n\n$apply_evolution\nNULL\n\n\nHomogensation assigns each geographic cluster the avaerage trait value weighted by the abundance of each population. Here larger populations contribute more than smaller populations to the avergae.\nAfter homogenisation, the trait evolves by drawing random values from a normal distribution and adding these to the traits. A mean of 0 ensures that positive trait changes and negative trait changes are equally likely. The trait_evolutionary_power variable detemines the degree of trait evolution, with higher values leading to higher average trait changes each time step. This process of adding a random normal variable approximates a Brownian motion model of trait evolution."
  },
  {
    "objectID": "Day1_Prac2_basics.html#ecology-interactions",
    "href": "Day1_Prac2_basics.html#ecology-interactions",
    "title": "2  ⛸️ Configure Skating",
    "section": "Ecology (interactions)",
    "text": "Ecology (interactions)\nEvery species present in a cell across the landscape has an abundance value representing the population size of the species in that location. The ecology function allows users to modify this abundance value based on environmental values, species interactions, or anything else relevant to the study. An abundance of 0 leads to the extinction of the species in that cell.\n\nconfig$gen3sis$ecology\n\n$apply_ecology\nNULL\n\n\nHere we use the temp trait (temperature niche position) and temp_breadth (temperature niche breadth) to determine whether a population can survive in cell. We get the absolute difference between the niche position and the temperature value in the grid cell. We then ask if this difference is more than the niche breadth. If it is larger, this means the value of the grid cell is outside the population’s niche breadth and it goes extinct in that grid cell. Extinction is indicated by giving the abundance a value of 0 or setting the abundance to FALSE as done here.\nOK, that gives you the basic overview of all the main components of the gen3sis model. We will now move on to running some simulations on an island case study. But before we do, we may want to save any changes we made to the config for later. To do this use the following code."
  },
  {
    "objectID": "Day1_Prac3_islands.html#dynamic-island-landscape",
    "href": "Day1_Prac3_islands.html#dynamic-island-landscape",
    "title": "3  🏝️ Island Hopping",
    "section": "Dynamic Island Landscape",
    "text": "Dynamic Island Landscape\n\n# load landscapes\nlc &lt;- readRDS(file.path(\"data\", \"landscapes\", \"islands\",\"landscapes.rds\"))\n\n# get names of landscape variables\nnames(lc)\n\n[1] \"elevation\" \"mean_temp\" \"min_temp\"  \"max_temp\"  \"patch\"    \n\n# get first time step\nfirst_step_pos &lt;- ncol(lc$mean_temp)\n\n# get first 10 sites of mean temperature for the 2 last time steps and the first (oldest) time step\nlc$mean_temp[100:110, c(1:4, first_step_pos)]\n\n       x    y        0        1      500\n100 39.5 58.5       NA       NA       NA\n101 40.5 58.5       NA       NA       NA\n102 41.5 58.5       NA       NA       NA\n103 42.5 58.5       NA       NA       NA\n104 43.5 58.5       NA       NA       NA\n105 44.5 58.5       NA       NA       NA\n106 45.5 58.5       NA       NA       NA\n107 46.5 58.5       NA       NA       NA\n108 47.5 58.5       NA 23.82152       NA\n109 48.5 58.5       NA 23.56207       NA\n110 49.5 58.5 24.89379 23.39746 24.85717\n\n\n\n# plot mean_temp for first and last time step\nplot(rast(lc$mean_temp[ ,c(1:3, first_step_pos)]))\n\n\n\n\nLook to see if there are any temporal trends in temperature or elevation.\n\npar(mfrow=c(1,2))\n# plot the change in mean tempereature through time\nmean_temperatures &lt;- colMeans(lc$mean_temp[, 3:ncol(lc$mean_temp)], na.rm=T)\nplot(seq(from=0, to = -5, by=-0.01),mean_temperatures ,  xlab=\"time (Ma)\", ylab=\"mean temperature\", type='l')\n\n# plot the change in mean elevation through time\nmean_elevation &lt;- colMeans(lc$elevation[, 3:ncol(lc$elevation)], na.rm=T)\nplot(seq(from=0, to = -5, by=-0.01), mean_elevation, xlab=\"time (Ma)\", ylab=\"mean elevation\", type='l')"
  },
  {
    "objectID": "Day1_Prac3_islands.html#model-1-config-time",
    "href": "Day1_Prac3_islands.html#model-1-config-time",
    "title": "3  🏝️ Island Hopping",
    "section": "Model 1: Config Time ⏰",
    "text": "Model 1: Config Time ⏰\nOpen the configs/config_islands_simple_Day1Prac3_M1.R script and have a look at it.\nOnce you are done, run a simulation. Note that we’re using a start time of 50 with 10-thousand-year time steps. So only the last 500 thousand years rather than the full 5 million. We will do this to keep things small.\n\n# run simulation\nsim_m1 &lt;- run_simulation(config = \"configs/config_islands_simple_Day1Prac3_M1.R\", \n                      landscape = \"data/landscapes/islands\", \n                      output_directory = \"output/islands\")\n\nInvestigate the output\n\nsim_m1 &lt;- readRDS(\"output/islands/config_islands_simple_Day1Prac3_M1/sgen3sis.rds\")\n\n\n# visualize the outputs\nplot_summary(sim_m1)\n\n\n\n\n\n# plot richness from summary in custom fashion, jsut to be familiar with the output\nna_mask &lt;- is.na(lc$elevation[,\"0\"])\nrich_m1 &lt;- sim_m1$summary$`richness-final`\nrich_m1[na_mask,3] &lt;- NA\nplot(rast(rich_m1, type=\"xyz\"), main=\"Richness\")\n\n\n\n\nPick a couple of random time points to look at specifically.\n\n# plot richness at time step 32 using saved data\nsps32 &lt;- readRDS(\"output/islands/config_islands_simple_Day1Prac3_M1/species/species_t_32.rds\")\nlc32 &lt;- readRDS(\"output/islands/config_islands_simple_Day1Prac3_M1/landscapes/landscape_t_32.rds\")\nplot_richness(sps32, lc32)\n\n\n\n# plot richness at time step 12 using saved data\nsps12 &lt;- readRDS(\"output/islands/config_islands_simple_Day1Prac3_M1/species/species_t_12.rds\")\nlc12 &lt;- readRDS(\"output/islands/config_islands_simple_Day1Prac3_M1/landscapes/landscape_t_12.rds\")\nplot_richness(sps12, lc12)\n\n\n\n\nNow look at the phylogeny\n\n# Now lets look at the Phylogeny\nlibrary(ape)\n\n\nAttaching package: 'ape'\n\n\nThe following objects are masked from 'package:terra':\n\n    rotate, trans, zoom\n\nphy_m1 &lt;- read.nexus(\"output/islands/config_islands_simple_Day1Prac3_M1/phy.nex\")\npar(mfrow=c(1,1))\nplot(phy_m1)"
  },
  {
    "objectID": "Day1_Prac3_islands.html#model-2-customise",
    "href": "Day1_Prac3_islands.html#model-2-customise",
    "title": "3  🏝️ Island Hopping",
    "section": "Model 2: Customise 💅",
    "text": "Model 2: Customise 💅\nLets start changing features of the config and compare the outputs to our first model.\n\n# load in config M1\nconf_m1 &lt;- create_input_config(\"configs/config_islands_simple_Day1Prac3_M1.R\")\n\n# load in config M2\nconf_m2 &lt;- create_input_config(\"configs/config_islands_simple_Day1Prac3_M2.R\")\n\n# previously, in M1, populations need 10 time steps to complete speciation\nconf_m1$gen3sis$speciation$divergence_threshold\n\n[1] 10\n\n# now populations only need 5 time steps to complete speciation\nconf_m2$gen3sis$speciation$divergence_threshold\n\n[1] 5\n\n#We have also change the observer function to save the presence/absence matrix for each time step.\n# see original config\nconf_m1$gen3sis$general$end_of_timestep_observer \n\nfunction (data, vars, config) \n{\n    plot_richness(data$all_species, data$landscape)\n    save_species()\n}\n&lt;environment: 0x000001deaec84290&gt;\n\n# see modeified config\nconf_m2$gen3sis$general$end_of_timestep_observer \n\nfunction (data, vars, config) \n{\n    plot_richness(data$all_species, data$landscape)\n    save_species()\n}\n&lt;environment: 0x000001deaed71598&gt;\n\n\nRun M2!\n\n# run the new model\nsim_m2 &lt;- run_simulation(config=\"configs/config_islands_simple_Day1Prac3_M2.R\", landscape=\"data/landscapes/islands\", output_directory=\"output/islands\")\n\n\n# original dynamics\nplot_summary(sim_m1)\n\n\n\n# modified dynamics\nsim_m2 &lt;- readRDS(\"output/islands/config_islands_simple_Day1Prac3_M2/sgen3sis.rds\")\nplot_summary(sim_m2)"
  },
  {
    "objectID": "Day1_Prac3_islands.html#model-3-specialise",
    "href": "Day1_Prac3_islands.html#model-3-specialise",
    "title": "3  🏝️ Island Hopping",
    "section": "Model 3: Specialise🏝️",
    "text": "Model 3: Specialise🏝️\nThe differences between M1 and M2 are predictable. Speciation happens a bit faster in M2, and you end up with more species. Overall, however, the patterns of richness are pretty similar. This suggests that this change in the rate of speciation isn’t having a big impact on geographic variation in where species are forming (at least from a first glance). So let’s try a new model that has a few more tweaks to see a more measurable effect.\n\n#load in the config for model M3\nconf_m3 &lt;- create_input_config(\"configs/config_islands_simple_Day1Prac3_M3.R\")\n\n# take a look at the initialisation\nconf_m3$gen3sis$initialization\n\n$initial_abundance\n[1] 1\n\n$create_ancestor_species\nfunction (landscape, config) \n{\n    co &lt;- landscape$coordinates\n    sp1 &lt;- co[which(co[, 1] &gt; 20 & co[, 2] &gt; 30), ]\n    sp2 &lt;- co[which(co[, 1] &lt; 20 & co[, 2] &lt; 30), ]\n    sp3 &lt;- co[which(co[, 1] &gt; 20 & co[, 2] &lt; 30), ]\n    sp4 &lt;- co[which(co[, 1] &lt; 20 & co[, 2] &gt; 30), ]\n    species_coords &lt;- list(sp1, sp2, sp3, sp4)\n    new_species &lt;- list()\n    new_species[[1]] &lt;- create_species(rownames(species_coords[[1]]), \n        config)\n    new_species[[1]]$traits[, \"dispersal\"] &lt;- 10\n    new_species[[1]]$traits[, \"temp_niche_centre\"] &lt;- mean(landscape$environment[rownames(species_coords[[1]]), \n        \"mean_temp\"])\n    new_species[[1]]$traits[, \"temp_niche_width\"] &lt;- 0.5\n    new_species[[1]]$traits[, \"start_island\"] &lt;- unique(landscape$environment[rownames(species_coords[[1]]), \n        \"patch\"])\n    new_species[[2]] &lt;- create_species(rownames(species_coords[[2]]), \n        config)\n    new_species[[2]]$traits[, \"dispersal\"] &lt;- 7.5\n    new_species[[2]]$traits[, \"temp_niche_centre\"] &lt;- mean(landscape$environment[rownames(species_coords[[2]]), \n        \"mean_temp\"])\n    new_species[[2]]$traits[, \"temp_niche_width\"] &lt;- 1\n    new_species[[2]]$traits[, \"start_island\"] &lt;- unique(landscape$environment[rownames(species_coords[[2]]), \n        \"patch\"])\n    new_species[[3]] &lt;- create_species(rownames(species_coords[[3]]), \n        config)\n    new_species[[3]]$traits[, \"dispersal\"] &lt;- 5\n    new_species[[3]]$traits[, \"temp_niche_centre\"] &lt;- mean(landscape$environment[rownames(species_coords[[3]]), \n        \"mean_temp\"])\n    new_species[[3]]$traits[, \"temp_niche_width\"] &lt;- 2\n    new_species[[3]]$traits[, \"start_island\"] &lt;- unique(landscape$environment[rownames(species_coords[[3]]), \n        \"patch\"])\n    new_species[[4]] &lt;- create_species(rownames(species_coords[[4]]), \n        config)\n    new_species[[4]]$traits[, \"dispersal\"] &lt;- 2.5\n    new_species[[4]]$traits[, \"temp_niche_centre\"] &lt;- mean(landscape$environment[rownames(species_coords[[4]]), \n        \"mean_temp\"])\n    new_species[[4]]$traits[, \"temp_niche_width\"] &lt;- 4\n    new_species[[4]]$traits[, \"start_island\"] &lt;- unique(landscape$environment[rownames(species_coords[[4]]), \n        \"patch\"])\n    return(new_species)\n}\n&lt;environment: 0x000001deac7cd418&gt;\n\n\nThere is a big differences here. In the initialization stage we give each species a different value of it’s dispersal ability and temperature width trait (niche breadth), and these are inversely related - high dispersing species have narrow niche breadths and low dispering species have wide niche breadths. This may create an interesting trade-off in dynamics of island colonization.\nRun the simulation\n\nsim_m3 &lt;- run_simulation(config=\"configs/config_islands_simple_Day1Prac3_M3.R\", \n                         landscape=\"data/landscapes/islands\",\n                         output_directory=\"output/islands\")\n\nNow compare the dynamics\n\nsim_m3 &lt;- readRDS(\"output/islands/config_islands_simple_Day1Prac3_M3/sgen3sis.rds\")\n\n# compare the plot summaries\nplot_summary(sim_m1)\n\n\n\nplot_summary(sim_m2)\n\n\n\nplot_summary(sim_m3)\n\n\n\n\n\n# lets also compare the phylogenies\npar(mfrow=c(1,3))\nphy_m1 &lt;- read.nexus(\"output/islands/config_islands_simple_Day1Prac3_M1/phy.nex\")\nplot(phy_m1)\nphy_m2 &lt;- read.nexus(\"output/islands/config_islands_simple_Day1Prac3_M2/phy.nex\")\nplot(phy_m2)\nphy_m3 &lt;- read.nexus(\"output/islands/config_islands_simple_Day1Prac3_M3/phy.nex\")\nplot(phy_m3)\n\n\n\ntrees &lt;- list(phy_m1, phy_m2, phy_m3)\nlibrary(\"ape\")\nlapply(trees, function(x){\n  mt &lt;- ape::balance(x)\n  mtn &lt;- (mt[,1]-mt[,2])/max(mt)\n  hist(abs(mtn))})\n\n\n\n\n[[1]]\n$breaks\n[1] 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7\n\n$counts\n[1] 6 0 0 1 1 0 1\n\n$density\n[1] 6.666667 0.000000 0.000000 1.111111 1.111111 0.000000 1.111111\n\n$mids\n[1] 0.05 0.15 0.25 0.35 0.45 0.55 0.65\n\n$xname\n[1] \"abs(mtn)\"\n\n$equidist\n[1] TRUE\n\nattr(,\"class\")\n[1] \"histogram\"\n\n[[2]]\n$breaks\n[1] 0.0 0.2 0.4 0.6 0.8 1.0\n\n$counts\n[1] 18  0  0  2  1\n\n$density\n[1] 4.2857143 0.0000000 0.0000000 0.4761905 0.2380952\n\n$mids\n[1] 0.1 0.3 0.5 0.7 0.9\n\n$xname\n[1] \"abs(mtn)\"\n\n$equidist\n[1] TRUE\n\nattr(,\"class\")\n[1] \"histogram\"\n\n[[3]]\n$breaks\n [1] 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0\n\n$counts\n [1] 60  2  2  0  0  0  0  0  1  2\n\n$density\n [1] 8.9552239 0.2985075 0.2985075 0.0000000 0.0000000 0.0000000 0.0000000\n [8] 0.0000000 0.1492537 0.2985075\n\n$mids\n [1] 0.05 0.15 0.25 0.35 0.45 0.55 0.65 0.75 0.85 0.95\n\n$xname\n[1] \"abs(mtn)\"\n\n$equidist\n[1] TRUE\n\nattr(,\"class\")\n[1] \"histogram\"\n\n\n\nExercise\nFrom the small tweak to the divergence factor and the initial conditions, we can see more species being generated in M2 and M3 compared to M1. We can also see extremely asymmetrical trees.\nReview the M2 and M3 config files and try to understand what they’re doing.\n\nHow are the dynamics through time in M2 and M3 different to M1, and how are they similar?\nAre the original occupants of each island diversifying at the same pace? How could you test this?\nConsider how you might modify the configuration or apply it to a specific research question.\nDo you think all islands would have similar degrees of phylogenetic diversity or turnover?\n\nWe’ll explore some of these questions tomorrow!"
  },
  {
    "objectID": "Day1_Prac3_islands.html#model-4-real",
    "href": "Day1_Prac3_islands.html#model-4-real",
    "title": "3  🏝️ Island Hopping",
    "section": "Model 4: Real👀",
    "text": "Model 4: Real👀\nIf you’ve managed to get through all of this, run M4 config and using what you’ve learned, plot some of the outputs. What has changed about this config?\n\nsim_m4 &lt;- run_simulation(config=\"configs/config_islands_simple_Day1Prac3_M4.R\", landscape=\"data/landscapes/islands\", output_directory=\"output/islands\")"
  },
  {
    "objectID": "Day2_Prac4_outputs.html#exploring-outputs",
    "href": "Day2_Prac4_outputs.html#exploring-outputs",
    "title": "4  🖥️ Silicodiversity",
    "section": "",
    "text": "A map of Species Richness from the simulation summary object\nA plot of Lineages Through Time from the phylogeny\nPlot of species trait values on a phylogenetic tree, by linking the species objects to the phylogeny\nMaps of Phylogenetic Diversity by linking species objects to the landscape and phylogeny\n\n\n\n\nSimulation summary object (sgen3sis.rds)\nThe first object we will look at today is the sgenesis.rds file. This file contains a summary of the simulation. Which we can plot (as we did yesterday) with the plot_summary function. This is the same object, that you would have in memory by running a simulation with run_simulation.\n\noutput_dir &lt;- \"output/islands\" \n\nsim &lt;- readRDS(file.path(output_dir, \"config_islands_simple_Day1Prac3_M3/sgen3sis.rds\")) \n\n# look at what the simulation summary contains\nnames(sim)\n\n[1] \"summary\"    \"flag\"       \"system\"     \"parameters\"\n\n\nThe first element is the sim summary. This contains a record of the history of speciation, extinction, and species richness through time (phylo_summary), a history of the number of total grid cells occupied during the simulation through time (occupancy) and the species richness of each grid cell at the final time step.\n\nstr(sim$summary)\n\nList of 3\n $ phylo_summary : num [1:52, 1:4] 4 4 4 4 4 4 4 4 5 5 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : chr [1:52] \"initial\" \"50\" \"49\" \"48\" ...\n  .. ..$ : chr [1:4] \"total\" \"alive\" \"speciations\" \"extinctions\"\n $ occupancy     : Named num [1:52] 1 0.522 0.523 0.521 0.512 ...\n  ..- attr(*, \"names\")= chr [1:52] \"initial\" \"50\" \"49\" \"48\" ...\n $ richness-final: num [1:3600, 1:3] 0.5 1.5 2.5 3.5 4.5 5.5 6.5 7.5 8.5 9.5 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : chr [1:3600] \"1\" \"2\" \"3\" \"4\" ...\n  .. ..$ : chr [1:3] \"x\" \"y\" \"0\"\n\n# phylo summary\nhead(sim$summary$phylo_summary)\n\n        total alive speciations extinctions\ninitial     4     4           4           0\n50          4     4           0           0\n49          4     4           0           0\n48          4     4           0           0\n47          4     4           0           0\n46          4     4           0           0\n\n# occupancy\nhead(sim$summary$occupancy)\n\n  initial        50        49        48        47        46 \n1.0000000 0.5215647 0.5232108 0.5211665 0.5117967 0.5004398 \n\n# occupancy\nhead(sim$summary$`richness-final`)\n\n    x    y 0\n1 0.5 59.5 0\n2 1.5 59.5 0\n3 2.5 59.5 0\n4 3.5 59.5 0\n5 4.5 59.5 0\n6 5.5 59.5 0\n\n\nThese data can be visualized with the plot_summary function\n\n# Visualize the outputs \nplot_summary(sim)\n\n\n\n\n\n\n\n\nWe can also use these data to map out patterns of species richness\n\n# make sure the landscape is loaded\nlc &lt;- readRDS(file.path(\"data\", \"landscapes\", \"islands\",\"landscapes.rds\"))\n\n# can remove cells with elevation below sea level at timestep 0 (present-day) to see the outlines of the islands\nna_mask &lt;- is.na(lc$elevation[,\"0\"])\nrich &lt;- sim$summary$`richness-final`\nrich[na_mask,3] &lt;- NA\n\n# turn richness summary into a raster \nrichness &lt;- rast(rich, type=\"xyz\")\n\n# plot, the sea is darblue, given by hexadecimal color code \nplot(richness, col=c(\"grey\", gen3sis::color_richness(12)), colNA=\"#000033\")\n\n\n\n\n\n\n\n\nThe next part of the simulation summary object is the flag which will tell us if the simulation ran successfully. It should give “OK”\n\nsim$flag\n\n[1] \"OK\"\n\n\nNext is the system summary. This is information about the R version, R packages, and operating system used in the simulation. This ensures complete repeatability. It also tells us the runtime of the simulation.\n\nsim$system\n\n$`runtime-hours`\n[1] 0.05406023\n\n$`gen3sis-version`\n[1] '1.5.11'\n\n$`R-version`\n               _                                \nplatform       x86_64-w64-mingw32               \narch           x86_64                           \nos             mingw32                          \ncrt            ucrt                             \nsystem         x86_64, mingw32                  \nstatus                                          \nmajor          4                                \nminor          2.2                              \nyear           2022                             \nmonth          10                               \nday            31                               \nsvn rev        83211                            \nlanguage       R                                \nversion.string R version 4.2.2 (2022-10-31 ucrt)\nnickname       Innocent and Trusting            \n\n$OS\n  sysname \n\"Windows\" \n\n$`session-information`\nR version 4.2.2 (2022-10-31 ucrt)\nPlatform: x86_64-w64-mingw32/x64 (64-bit)\nRunning under: Windows 10 x64 (build 19045)\n\nMatrix products: default\n\nlocale:\n[1] LC_COLLATE=English_Australia.utf8  LC_CTYPE=English_Australia.utf8   \n[3] LC_MONETARY=English_Australia.utf8 LC_NUMERIC=C                      \n[5] LC_TIME=English_Australia.utf8    \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] here_1.0.1      picante_1.8.2   nlme_3.1-160    vegan_2.6-4    \n [5] lattice_0.20-45 permute_0.9-7   phytools_2.1-1  maps_3.4.1     \n [9] ape_5.7-1       terra_1.7-29    gen3sis_1.5.11 \n\nloaded via a namespace (and not attached):\n [1] Rcpp_1.0.10             compiler_4.2.2          iterators_1.0.14       \n [4] tools_4.2.2             digest_0.6.31           lifecycle_1.0.4        \n [7] gdistance_1.6.4         mgcv_1.8-42             pkgconfig_2.0.3        \n[10] rlang_1.1.3             fastmatch_1.1-3         Matrix_1.6-5           \n[13] foreach_1.5.2           igraph_2.0.3            cli_3.6.0              \n[16] rstudioapi_0.14         parallel_4.2.2          expm_0.999-7           \n[19] xfun_0.47               coda_0.19-4.1           cluster_2.1.4          \n[22] stringr_1.5.1           raster_3.6-26           knitr_1.48             \n[25] vctrs_0.6.0             generics_0.1.3          rprojroot_2.0.4        \n[28] scatterplot3d_0.3-44    combinat_0.0-8          grid_4.2.2             \n[31] glue_1.6.2              optimParallel_1.0-2     phangorn_2.11.1        \n[34] sp_2.1-4                magrittr_2.0.3          splines_4.2.2          \n[37] codetools_0.2-19        MASS_7.3-58.3           mnormt_2.1.1           \n[40] numDeriv_2016.8-1.1     quadprog_1.5-8          stringi_1.7.12         \n[43] doParallel_1.0.17       clusterGeneration_1.3.8\n\n\nFinally the summary object contains the config information and model parameters used.\n\nsim$parameters\n\n$gen3sis\n$gen3sis$general\n$gen3sis$general$random_seed\n[1] 666\n\n$gen3sis$general$start_time\n[1] 50\n\n$gen3sis$general$end_time\n[1] 0\n\n$gen3sis$general$max_number_of_species\n[1] 50000\n\n$gen3sis$general$max_number_of_coexisting_species\n[1] 20000\n\n$gen3sis$general$end_of_timestep_observer\nfunction(data, vars, config){  \n  \n  plot_richness(data$all_species, data$landscape)\n  \n  save_species() # saves a species and landscape objects for desired timesteps\n  \n}\n&lt;environment: 0x000001142af14c40&gt;\n\n$gen3sis$general$trait_names\n[1] \"dispersal\"         \"temp_niche_centre\" \"temp_niche_width\" \n[4] \"start_island\"     \n\n$gen3sis$general$environmental_ranges\nlist()\n\n$gen3sis$general$verbose\n[1] 1\n\n\n$gen3sis$initialization\n$gen3sis$initialization$initial_abundance\n[1] 1\n\n$gen3sis$initialization$create_ancestor_species\nfunction(landscape, config) {\n  # browser()\n  co &lt;- landscape$coordinates\n  \n  # If we wouldn't have passe the patches though the environment, we could have done this:\n  # sp1 &lt;- co[which(co[,1]&lt;20&co[,2]&lt;30),]\n  # sp2 &lt;- co[which(co[,1]&gt;20&co[,2]&lt;30),]\n  # sp3 &lt;- co[which(co[,1]&lt;20&co[,2]&gt;30),]\n  # sp4 &lt;- co[which(co[,1]&gt;20&co[,2]&gt;30),]\n  \n  # however, we made thinks simpler to you.\n  # get patches vector\n  pv &lt;- landscape$environment[, \"patch\"]\n  \n  # species_coords &lt;- list(sp1,\n  #                        sp2,\n  #                        sp3,\n  #                        sp4)\n  new_species &lt;- list()\n  \n  \n  manual_traits &lt;- list(\n    \"dispersal\" = c(10, 7.5, 5, 2.5),\n    \"temp_niche_width\" = c(0.5, 1, 2, 4)\n  )\n  \n  for (sp_i in 1:4){\n    # create a species empty object\n    new_species[[sp_i]] &lt;- create_species(names(pv[pv==sp_i]), config)\n    # set manual dispersal and niche width\n    new_species[[sp_i]]$traits[ , \"dispersal\"] &lt;- manual_traits$\"dispersal\"[sp_i]\n    new_species[[sp_i]]$traits[ , \"temp_niche_width\"] &lt;- manual_traits$\"temp_niche_width\"[sp_i]\n    # set species 1 start to island 1, species 2 to island 2, etc...\n    new_species[[sp_i]]$traits[ , \"start_island\"] &lt;- unique(landscape$environment[pv==sp_i, \"patch\"]) # this is just a sanity check\n    # set species mean temp to the mean temp of the patches\n    new_species[[sp_i]]$traits[ , \"temp_niche_centre\"] &lt;- mean(landscape$environment[pv==sp_i, \"mean_temp\"])\n  }\n  \n  return(new_species)\n}\n&lt;environment: 0x000001142af14c40&gt;\n\n\n$gen3sis$dispersal\n$gen3sis$dispersal$max_dispersal\n[1] Inf\n\n$gen3sis$dispersal$get_dispersal_values\nfunction(n, species, landscape, config){\n  #browser()\n  values &lt;- rexp(n, rate = 1/species$traits[,\"dispersal\"])\n  return(values)\n}\n&lt;environment: 0x000001142af14c40&gt;\n\n\n$gen3sis$speciation\n$gen3sis$speciation$divergence_threshold\n[1] 5\n\n$gen3sis$speciation$get_divergence_factor\nfunction(species, cluster_indices, landscape, config) {\n  return(1)\n}\n&lt;environment: 0x000001142af14c40&gt;\n\n\n$gen3sis$mutation\n$gen3sis$mutation$apply_evolution\nfunction(species, cluster_indices, landscape, config) {\n  # cell names\n  trait_evolutionary_power &lt;-0.05\n  traits &lt;- species[[\"traits\"]]\n  cells &lt;- rownames(traits)\n  #homogenize trait based on abundance\n  # Homogenize all traits by weighted abundance, attention, exclude here any trait that should be more neutral\n  trn &lt;- config$gen3sis$general$trait_names\n  for(cluster_index in unique(cluster_indices)){\n    # cluster_index &lt;- 1\n    cells_cluster &lt;- cells[which(cluster_indices == cluster_index)]\n    # hist(traits[cells_cluster, \"temp\"], main=\"before\")\n    mean_abd &lt;- mean(species$abundance[cells_cluster])\n    weight_abd &lt;- species$abundance[cells_cluster]/mean_abd\n    for (ti in trn){\n      traits[cells_cluster, ti] &lt;- mean(traits[cells_cluster, ti]*weight_abd)\n    }\n    # hist(traits[cells_cluster, \"temp\"], main=\"after\")\n  }\n  \n  # mutate mean temperature\n  mutation_deltas &lt;-rnorm(length(traits[, ti]), mean=0, sd=trait_evolutionary_power)\n  traits[, \"temp_niche_centre\"] &lt;- traits[, \"temp_niche_centre\"] + mutation_deltas\n  return(traits)\n}\n&lt;environment: 0x000001142af14c40&gt;\n\n\n$gen3sis$ecology\n$gen3sis$ecology$apply_ecology\nfunction(abundance, traits, landscape, config) {\n  # get the difference between species and site mean temp\n  diff &lt;- abs(traits[, \"temp_niche_centre\"]-landscape[,\"mean_temp\"])\n  # set the abundance of species with a difference in mean temp larger than the species temp width to zero and the ones below to one\n  abundance[diff&gt;traits[,\"temp_niche_width\"]] &lt;- 0\n  abundance[diff&lt;=traits[,\"temp_niche_width\"]] &lt;- 1\n  return(abundance)\n}\n&lt;environment: 0x000001142af14c40&gt;\n\n\n\n$user\nlist()\n\n$directories\n$directories$input\n[1] \"data/landscapes/islands\"\n\n$directories$output\n[1] \"output/islands/config_islands_simple_Day1Prac3_M3\"\n\n$directories$output_plots\n[1] \"output/islands/config_islands_simple_Day1Prac3_M3/plots\"\n\n\nattr(,\"class\")\n[1] \"gen3sis_config\"\n\n\n\n\nPhylogeny object (phy.nex)\nThe phylogeny object is pretty straight forward. It is a nexus file containing the relationships between the species.\n\n# read phy\nphy &lt;- read.nexus(file.path(output_dir, \"config_islands_simple_Day1Prac3_M3/phy.nex\"))\n\n# plot phy\nplot(phy)\n\n\n\n\n\n\n\n\nFrom this object we can look at lineages through time plots and estimate trends in diversification. The gamma statistic is one way to detect diversification slowdowns or speedups, with positive values indicating nodes are more closely pushed up towards the tips (speed up) and negative values indicating nodes are closer to the root (slowdown) (Pybus and Harvey 2000). There are lots of other kinds of measures of phylogenetic tree shape, such as metrics of tree imbalance (Colless’s Index, Beta-Splitting Paramater, etc.)\n\n# plot an ltt\nltt_M1 &lt;-ltt(phy)\n\n\n\n\n\n\n\n# look at the gamma statistic\nprint(paste0(\"Gamma = \", round(ltt_M1$gamma, 2)))\n\n[1] \"Gamma = -0.69\"\n\n# is there a significant deviation from constant rates?\nprint(paste0(\"P = \", round(ltt_M1$p, 2)))\n\n[1] \"P = 0.49\"\n\n\n\n\nSpecies objects (phy.nex)\nNow its time to get into the meat of the gen3sis outputs. Most of the information from the simulation is stored in the species objects. These are .rds files that contain a list which includes information on every species, extinct or extant, that existed during the simulation. These are saved per default at every time step, but can be fine tuned according to your needs. The naming convention is “species_t_0.rds” for time step 0 (present-day), and “species_t_50” for timestep 50, etc.\n\n# load object\nspecies_t_0 &lt;- readRDS(file.path(output_dir, \"config_islands_simple_Day1Prac3_M3\", \"species\", \"species_t_0.rds\"))\n\n# look at object class and length\nclass(species_t_0)\n\n[1] \"list\"\n\nlength(species_t_0)\n\n[1] 79\n\n# compare to number of tips in the phylogeny\nNtip(phy)\n\n[1] 79\n\n\nThere are 14 elements in the list, representing our 14 species and this number matches the number of species in our phylogeny. No species went extinct in this particular simulation, but if they did, they would match extinct tips in the phylogeny.\nLets look at a single species\n\nnames(species_t_0[[1]])\n\n[1] \"id\"         \"abundance\"  \"traits\"     \"divergence\"\n\n\nThe species has an ID which allows us to match it to the phylogeny.\n\nspecies_t_0[[1]]$id\n\n[1] \"1\"\n\n\nThe species’ abundances are also linked to grid cells in the landscape, which can be matched with their corresponding names.\n\nspecies_t_0[[1]]$abundance\n\n249 250 251 252 289 290 291 306 307 313 316 348 349 352 353 354 364 365 366 377 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n406 407 408 414 415 423 439 440 465 466 467 476 482 500 525 560 561 584 597 618 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n619 620 645 656 657 662 678 679 705 706 716 717 722 723 737 738 766 767 776 783 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n784 785 795 796 827 835 836 845 846 847 848 849 853 854 888 889 890 892 893 894 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n909 910 951 953 \n  1   1   1   1 \n\n\nIn this case the species has abundance values of 1 in all populations from the cells that it occupies. This is because we set abundances to be binary: 1=present, 0=absent. We can see the species occupies cells 247, 248, 249, etc.\nThe species also has values of it’s traits for each of its populations.\n\nhead(species_t_0[[1]]$traits)\n\n    dispersal temp_niche_centre temp_niche_width start_island\n249        10          20.77320              0.5            1\n250        10          20.78322              0.5            1\n251        10          20.84116              0.5            1\n252        10          20.76937              0.5            1\n289        10          20.77562              0.5            1\n290        10          20.85630              0.5            1\n\n\nWe can see the population that each row is linked by the rownames. Here you can see 247, 248, 249, etc. Each of these populations have a dispersal trait of 5 (because we didn’t vary this) slightly different temp_mean traits (because these evolved stochastically under a Brownian motion model) and a temp width of 1 (again, we didn;t vary this in model 1).\nSo, if we want to map out the distribution of species 1 at timestep 0, we just need to link those cell names (267/268/etc) to the landscape object and make a raster. Why don;t we try and see what islands species 1 is found on.\n\npar(mfrow=c(1,3))\n# first plot the islands out from the landscape object\npatch_xyz &lt;- rast(lc$patch[,c(\"x\", \"y\", \"0\")], type=\"xyz\")\nplot(patch_xyz, main=\"Island Patches\", col=palette()[c(2,3,4,6)], colNA=\"#000033\")\n\n# pull out values of the landscape where the species is found\nspecies1_xyz &lt;- lc$patch[which(rownames(lc$patch) %in% rownames(species_t_0[[1]]$traits)), c(\"x\", \"y\", \"0\")]\n\n# turn it into a raster\nspecies1_xyz &lt;- rast(species1_xyz, type=\"xyz\")\nspecies1_xyz &lt;- extend(species1_xyz, patch_xyz)\nplot(species1_xyz, main= \"Species 1 Distribution\", colNA=\"#000033\")\n\n# alternatively we can use the plot_species function on gen3sis..\n# for that we load the landscape object of the respective time-step\nlandscape_t_0 &lt;- readRDS(file.path(output_dir, \"config_islands_simple_Day1Prac3_M1\", \"landscapes\", \"landscape_t_0.rds\"))\ngen3sis::plot_species_presence(species_t_0[[1]], landscape_t_0)\n\n\n\n\n\n\n\n\n\n\nLinking the species object and phylogeny\nLets try and link the species trait data to the phylogeny to start learning something about what exactly took place during our simulation! Let’s get the mean trait value of the temperature niche and also the islands that each species belongs too.\n\n# lets create a data frame\ndaf &lt;- data.frame(\"id\"= paste0(\"species\",sapply(species_t_0, function(x)x$id)),\n                 \"mean_temp\"=NA,\n                 \"island1\"=0,\n                 \"island2\"=0,\n                 \"island3\"=0,\n                 \"island4\"=0, \n                 \"island_start\"=NA)\n\n# take a look\nhead(daf)\n\n        id mean_temp island1 island2 island3 island4 island_start\n1 species1        NA       0       0       0       0           NA\n2 species2        NA       0       0       0       0           NA\n3 species3        NA       0       0       0       0           NA\n4 species4        NA       0       0       0       0           NA\n5 species5        NA       0       0       0       0           NA\n6 species6        NA       0       0       0       0           NA\n\n# Use sapply on the species object to get their mean trait values\ndaf$mean_temp &lt;- sapply(species_t_0, function(x){\n  # x &lt;- species_t_0[[1]]\n  mean(x$traits[, \"temp_niche_centre\"], na.rm=T)\n  })\n\n# Get the island patch id values in a for loop\nfor(i in 1:length(species_t_0)){\n  #I'm here because it is a good idea to test code on a single species before running it on all species\n  # i &lt;- 1 \n  # as before we get the lanscape values of each species\n  speciesi_xyz &lt;- lc$patch[which(rownames(lc$patch) %in% rownames(species_t_0[[i]]$traits)), c(\"x\", \"y\", \"0\")]\n  \n  # then pull out the unique values (note that species might occur on more than one island)\n  islands &lt;- unique(speciesi_xyz[, 3])\n  \n  # then if species are on the island, give that column a value of 1\n  \n  daf$island1[i] &lt;- ifelse(1 %in% islands, 1, 0)\n  daf$island2[i] &lt;- ifelse(2 %in% islands, 1, 0)\n  daf$island3[i] &lt;- ifelse(3 %in% islands, 1, 0)\n  daf$island4[i] &lt;- ifelse(4 %in% islands, 1, 0)\n}\n\n# get the starting island from the traits object since we recorded this in the initialization step\ndaf$island_start &lt;- sapply(species_t_0, function(xasa) unique(xasa$traits[, \"start_island\"]))\n\nNow look again at the data frame\n\nhead(daf)\n\n        id mean_temp island1 island2 island3 island4 island_start\n1 species1  20.81620       1       1       0       0            1\n2 species2  20.89374       1       1       0       0            2\n3 species3  21.13878       0       0       1       0            3\n4 species4  21.97150       0       0       0       1            4\n5 species5  20.77629       1       1       0       0            1\n6 species6  20.79492       1       1       0       0            1\n\n\nPlot out the continuously evolving temperature niche trait\n\n# create a named vector for the log of the temperature niche trait\ntemp_niche &lt;- daf$mean_temp\nnames(temp_niche) &lt;- daf$id\n\n# plot it out with dots = trait\ndotTree(phy,temp_niche,ftype=\"i\", length=8, fsize=1.2, standardize=T)\n\n\n\n\n\n\n\n\nNot much variation in that trait, due to the combined effects of trait homogenization and a low rate of change. Lets plot the tip states of the islands on the phylogeny using the phytools package\n\npar(mfrow=c(1,2))\n\n# format each island\nformatIsland &lt;- function(island, phy=phy, daf=daf){\n  islandf &lt;- as.factor(daf[, island])\n  names(islandf) &lt;- daf$id\n  islandmat&lt;-to.matrix(islandf,levels(islandf))\n  islandmat&lt;-islandmat[phy$tip.label,]\n  return(list(islandf, islandmat))\n}\n\n\nplotTree(phy,ftype=\"i\",offset=1,fsize=0.9, xlim=c(0, 75))\n\ntiplabels(pie=formatIsland(island=\"island1\", phy=phy, daf=daf)[[2]],piecol=palette()[c(8,2)],cex=0.6, adj=12+1)\ntiplabels(pie=formatIsland(island=\"island2\", phy=phy, daf=daf)[[2]],piecol=palette()[c(8,3)],cex=0.6, adj=12+3)\ntiplabels(pie=formatIsland(island=\"island3\", phy=phy, daf=daf)[[2]],piecol=palette()[c(8,4)],cex=0.6, adj=12+5)\ntiplabels(pie=formatIsland(island=\"island4\", phy=phy, daf=daf)[[2]],piecol=palette()[c(8,6)],cex=0.6, adj=12+7)\n\nplot(patch_xyz, main=\"Island Patches\", col=palette()[c(2,3,4,6)])\n\nInteresting. What do you notice about the distribution of species on islands? Could you predict which island each lineage began on?\nWe actually know which islands each lineage started on because we recorded this as a trait (we could also look at the past species objects to figure this out but we have used a shortcut though the traits).\n\npar(mfrow=c(1,2))\nplotTree(phy,ftype=\"i\",offset=1,fsize=0.4, xlim=c(0, 75))\nmy_cex=1.2\ntiplabels(pie=formatIsland(island=\"island1\", phy=phy, daf=daf)[[2]],piecol=palette()[c(8,2)],cex=my_cex, adj=12+1)\ntiplabels(pie=formatIsland(island=\"island2\", phy=phy, daf=daf)[[2]],piecol=palette()[c(8,3)],cex=my_cex, adj=12+3)\ntiplabels(pie=formatIsland(island=\"island3\", phy=phy, daf=daf)[[2]],piecol=palette()[c(8,4)],cex=my_cex, adj=12+5)\ntiplabels(pie=formatIsland(island=\"island4\", phy=phy, daf=daf)[[2]],piecol=palette()[c(8,6)],cex=my_cex, adj=12+7)\n\n# add the starting island as a fifth colum\ntiplabels(pie=formatIsland(island=\"island_start\", phy=phy, daf=daf)[[2]],piecol=palette()[c(2,3,4,6)],cex=1.6, adj=12+9, pch=7)\n\n# add island plot\nplot(patch_xyz, main=\"Island Patches\", col=palette()[c(2,3,4,6)])\n\nSo whats really apparent here is that the clade that originated on the green island has speciated allopatrically into the red island multiple times in the recent past. The same is true for the red clade, however the deeper divergence between species9 and species3 have had enough time to recolonize both islands.\n\n\n4.0.0.1 Linking the species object, landscape, and phylogeny\nCommon spatial biodiversity analyses link information measured at the species level to maps of their distribution in space using presence-absence matrices or PAMs. PAMs typically are data frame with each row representing a site, could be an island or could be a grid cell, and each column representing a species. Values of 1 are given if the species is present in the site, if not a value of 0 is given.\n\n# grid cell level PAM\n\n# create an empty data frame with the dimensions of species x sites\nPAM &lt;- data.frame(matrix(0, nrow=nrow(lc$elevation), ncol=length(species_t_0)))\n\n# given names to rows and columns\nrownames(PAM) &lt;- rownames(lc$elevation)\ncolnames(PAM) &lt;- paste0(\"species\", sapply(species_t_0, function(x)x$id))\n\n# loop over species and add value of 1 to all sites the species is present\nfor(i in 1:length(species_t_0)){\n  \n  PAM[which(rownames(PAM) %in% names(species_t_0[[i]]$abundance)), i] &lt;- 1\n}\n\n# how does it look?\nprint(PAM[1:10, 1:10])\n\n   species1 species2 species3 species4 species5 species6 species7 species8\n1         0        0        0        0        0        0        0        0\n2         0        0        0        0        0        0        0        0\n3         0        0        0        0        0        0        0        0\n4         0        0        0        0        0        0        0        0\n5         0        0        0        0        0        0        0        0\n6         0        0        0        0        0        0        0        0\n7         0        0        0        0        0        0        0        0\n8         0        0        0        0        0        0        0        0\n9         0        0        0        0        0        0        0        0\n10        0        0        0        0        0        0        0        0\n   species9 species10\n1         0         0\n2         0         0\n3         0         0\n4         0         0\n5         0         0\n6         0         0\n7         0         0\n8         0         0\n9         0         0\n10        0         0\n\n\n\n# we can estimate Phylogenetic diversity\npd_islands &lt;- pd(PAM, phy)\n\n# we can also measure mean phylogenetic distance and mean nearest neighbour distance\nmpd_islands &lt;- mpd(PAM, cophenetic(phy))\nmntd_islands &lt;- mntd(PAM,cophenetic(phy))\n\n# link these back with the landscape by joining to the landscape lat/long\ncommunity_phylo &lt;- cbind(lc$elevation[, c(\"x\", \"y\")], pd_islands, mpd_islands, mntd_islands)\n\npar(mfrow=c(2,2))\nsr_ras &lt;- rast(community_phylo[, c(\"x\", \"y\", \"SR\")], type=\"xyz\")\npd_ras &lt;- rast(community_phylo[, c(\"x\", \"y\", \"PD\")], type=\"xyz\")\nmpd_ras &lt;- rast(community_phylo[, c(\"x\", \"y\", \"mpd_islands\")], type=\"xyz\")\nmntd_ras &lt;- rast(community_phylo[, c(\"x\", \"y\", \"mntd_islands\")], type=\"xyz\")\n\nplot(sr_ras, main=\"Species Richness\", na.color =\"red\")\nplot(pd_ras, main=\"Phylogenetic Diversity\")\nplot(mpd_ras, main=\"Mean Phylogenetic Pairwise Distance\")\nplot(mntd_ras, main= \"Mean Nearest Neighbour Phylogenetic Distance\")",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>🖥️ Silicodiversity</span>"
    ]
  },
  {
    "objectID": "Day2_Prac4_outputs.html#sensitivity-analysis",
    "href": "Day2_Prac4_outputs.html#sensitivity-analysis",
    "title": "4  🖥️ Silicodiversity",
    "section": "Sensitivity analysis",
    "text": "Sensitivity analysis\nIn this part we are going to load in a data set from Skeels et al. (2022) SystBiol in which we simulated data with Gen3sis under four alternative models to test the evolutionary speed hypothesis (ESH). The ESH hypothesizes that faster rates of evolution occurs in lineages from warm regions like the tropics because they are have higher mutagenesis from faster life histories associated with warm temperatures and smaller body sizes. The four models used there were\n\nM0 - the null. population divergence is independent of temperature and body size\nM1 - Temperature Trailblazer. environmental temperature drives rate of population divergence\nM2 - Size Shaper. body size drives the rate of population divergence\nM3 - Synergistic Drivers. environmental temperature and body size drives the rate of population divergence\n\n\n\n\nSkeels et al. 2022 Syst. Biol. Figure 1\n\n\nNot only did we change the overall model of evolution, we also varied key parameters for rates of niche evolution (simga_squared_t), rates of body size evolution (sigma_squared_bs), dispersal, and the temperature niche breadth (omega), the exponent of the divergence factor with temp/body size (lambda), and the divergence threshold. Load in the data and take a look, the first 6 columns are the model parameters we varied.\n\nsim_data &lt;- read.csv(\"data/simulated_summary_statistics.csv\")\n\n# look at the first few columns\nhead(sim_data)\n\n  divergence_threshold lambda omega sigma_squared_bs sigma_squared_t dispersal\n1                    6  3.497 0.022            0.010           0.008     2.748\n2                    8  2.743 0.029            0.006           0.012     2.119\n3                    4  4.251 0.016            0.015           0.004     3.376\n4                    5  3.120 0.026            0.003           0.013     3.691\n5                    9  4.629 0.013            0.013           0.006     2.433\n6                    7  2.365 0.019            0.008           0.003     3.062\n   m n_extant_diversity richness_lat_cor richness_temp0mya_cor temp_skewness\n1 m0               3763       -0.5123028             0.4603989    -0.3377488\n2 m0               2514       -0.4425833             0.3879755    -0.4301348\n3 m0               2881       -0.6090030             0.5980889    -0.5485366\n4 m0               3259       -0.2692291             0.2709599    -0.4056149\n5 m0               1720       -0.6320276             0.5569583    -0.2034315\n6 m0               2040       -0.6901237             0.7143851    -0.5818263\n  temp_kurtosis rs_skewness rs_kurtosis bodysize_temp_cor\n1      2.404199    7.054563    70.57922      0.0001267958\n2      2.781235    7.065556    73.60686     -0.0573601538\n3      2.686734    6.568041    66.80411      0.0627634742\n4      2.578726    6.372164    56.40946     -0.0099951252\n5      2.039092    5.943670    62.21730     -0.0491801922\n6      2.692505    5.557220    43.19415     -0.1425113733\n  bodysize_rangesize_cor rangesize_temp_cor bodysize_MRDa_cor bodysize_MRDn_cor\n1           -0.021888162          0.3166909       -0.22987475       -0.22987475\n2           -0.004099039          0.3750050        0.11431674        0.11431674\n3           -0.007583409          0.1745926       -0.17385167       -0.17385167\n4            0.019477523          0.3315223        0.15882106        0.15882106\n5           -0.020735305          0.3106268       -0.01367189       -0.01367189\n6           -0.068035906          0.2386339       -0.25345879       -0.25345879\n  bodysize_MRDs_cor bodysize_ED_cor bodysize_ES_cor bodysize_DR_cor\n1       -0.22987475    -0.004220075    -0.001379360     0.004220206\n2        0.11431674    -0.048918445    -0.047336234     0.048918445\n3       -0.17385167     0.156214848     0.124189954    -0.156214848\n4        0.15882106     0.025569939     0.020867045    -0.025569939\n5       -0.01367189    -0.091018579    -0.071841554     0.091018579\n6       -0.25345879    -0.011839185    -0.009998883     0.011839185\n  temp_MRDa_cor temp_MRDn_cor temp_MRDs_cor temp_ED_cor temp_ES_cor temp_DR_cor\n1   -0.26576712   -0.26576712   -0.26576712  0.26183743   0.2202009 -0.26183732\n2   -0.17175772   -0.17175772   -0.17175772  0.24312164   0.2193826 -0.24312164\n3   -0.26126033   -0.26126033   -0.26126033  0.20306519   0.2015201 -0.20306519\n4   -0.18047283   -0.18047283   -0.18047283  0.09627562   0.0921575 -0.09627562\n5   -0.29855804   -0.29855804   -0.29855804  0.51772365   0.4230468 -0.51772365\n6    0.05847105    0.05847105    0.05847105  0.11024859   0.1080941 -0.11024859\n  rangesize_MRDa_cor rangesize_MRDn_cor rangesize_MRDs_cor rangesize_ED_cor\n1        -0.06934918        -0.06934918        -0.06934918       0.08511133\n2        -0.10091990        -0.10091990        -0.10091990       0.12507118\n3         0.04022504         0.04022504         0.04022504      -0.09452590\n4        -0.04660310        -0.04660310        -0.04660310       0.07933631\n5        -0.13259037        -0.13259037        -0.13259037       0.18191779\n6         0.06267093         0.06267093         0.06267093      -0.01025940\n  rangesize_ES_cor rangesize_DR_cor  collessI    sackinI     gamma  lat_pd_cor\n1      0.077434173      -0.08511127 1.2941150  1.2446979 -2.842964  0.31465895\n2      0.122658910      -0.12507118 0.2469526  0.3055442 -3.432895  0.25315279\n3     -0.069705157       0.09452590 1.7248814  1.6445494  3.552396  0.18284230\n4      0.087443271      -0.07933631 0.1092457 -0.1254847 -2.856134  0.11539323\n5      0.147346956      -0.18191779 1.9250034  1.8373325  1.221135 -0.06489522\n6      0.006120436       0.01025940 1.4952264  1.3605311 -5.120426  0.53662583\n  lat_mpd_cor lat_mntd_cor temp_pd_cor temp_mpd_cor temp_mntd_cor\n1  0.03036122   0.33145967 -0.24781657   0.01816540  -0.268472337\n2  0.10829373   0.24772423 -0.19630776  -0.09235074  -0.184665665\n3  0.18551711   0.24143456 -0.18427695  -0.19302604  -0.243213118\n4 -0.03477720   0.15145822 -0.09837927   0.03810852  -0.129764794\n5 -0.20454388   0.09798374  0.14050779   0.24629073  -0.006957113\n6  0.46224942   0.53924111 -0.54984407  -0.47923803  -0.551691573\n  richness_pd_cor richness_mpd_cor richness_mntd_cor temp_bsm_cor temp_bssd_cor\n1      -0.7653721      -0.41190740        -0.7499123   0.13029352    0.10296607\n2      -0.5019377      -0.13404370        -0.4901978   0.02405246    0.32276835\n3      -0.4206957      -0.37006059        -0.5361401   0.29116267    0.28959998\n4      -0.6620540      -0.41176821        -0.6769946  -0.05320780    0.04856645\n5      -0.1328847       0.06086838        -0.2905060  -0.08286640    0.08193951\n6      -0.8328187      -0.71895993        -0.8346579   0.31747185    0.34586235\n  richness_bsm_cor richness_bssd_cor   pd_bsm_cor mpd_bsm_cor mntd_bsm_cor\n1       0.11558582         0.2699839  0.003325102   0.2260060  -0.05039301\n2      -0.04537885         0.3499518 -0.263036186  -0.2484294  -0.25064129\n3       0.23668036         0.3628398  0.515713659   0.4795434   0.49672112\n4       0.04042515         0.1778522 -0.052266148  -0.1187109  -0.03605613\n5       0.31046985         0.3722813  0.061612978   0.1029425   0.06221910\n6       0.45747017         0.3837205 -0.038428520   0.3474728  -0.12562991\n\n# look at the models\nunique(sim_data$m)\n\n[1] \"m0\" \"m1\" \"m2\" \"m3\"\n\n\nThis data set has 27 metrics used in our paper to measure patterns in the distribution of species, such as range size metrics, or correlations between temperature and diversity, as well as phylogenetic tree shape metrics, such as gamma, and measures of functional diversity, like body size variance. We predicted that these different models of evolution (M0-M4) should leave discernible signatures in these metrics. We can plot a few associations between biodiversity metrics and these model parameters to test this hypothesis.\n\nrequire(ggplot2)\n\n# how is diversity related to the dispersal ability of a clade?\nggplot(sim_data, aes(x=m, y=log(n_extant_diversity), fill=m))+\n  geom_point(alpha=0.7, position = \"jitter\")+\n  geom_boxplot(alpha=0.7)+\n  stat_smooth()+\n  theme_classic()\n\n\n\n\n\n\n\n# how about the temperature~diversity gradient?\nggplot(sim_data, aes(x=m, y=richness_temp0mya_cor, fill=m))+\n  geom_point(alpha=0.7, position = \"jitter\")+\n  geom_boxplot(alpha=0.7)+\n  stat_smooth()+\n  theme_classic()\n\n\n\n\n\n\n\n# how about the relationship between  body size and diversification rate?\nggplot(sim_data, aes(x=m, y=bodysize_DR_cor, fill=m))+\n  geom_point(alpha=0.7, position = \"jitter\")+\n  geom_boxplot(alpha=0.7)+\n  stat_smooth()+\n  theme_classic()\n\n\n\n\n\n\n\n# how about the relationship between temperature and diversification rate?\nggplot(sim_data, aes(x=m, y=temp_DR_cor, fill=m))+\n  geom_point(alpha=0.7, position = \"jitter\")+\n  geom_boxplot(alpha=0.7)+\n  stat_smooth()+\n  theme_classic()\n\n\n\n\n\n\n\n\nDo these patterns fit our predictions? We can also look at how some of these metrics varied with the continuous model parameters such as dispersal ability.\n\n# how is diversity related to the dispersal ability of a clade?\nggplot(sim_data, aes(x=dispersal, y=log(n_extant_diversity)))+\n  geom_point(alpha=0.7)+\n  stat_smooth()+\n  theme_classic()\n\n\n\n\n\n\n\n# how about the latitude diversity gradient?\nggplot(sim_data, aes(x=dispersal, y=temp_DR_cor))+\n  geom_point(alpha=0.7)+\n  stat_smooth()+\n  theme_classic()\n\n\n\n\n\n\n\n\nTo perform a simple kind of sensitivity test we might ask how each of the model parameters predicts linear changes in the distribution of a biodiversity patterns using a multiple regression model. One example where we have a good idea of what the relationship should be is the how variance in the distribution of temperature niches across species (e.g., skewness of the distribution) relates to model paramaters. We expect that this should scale with the rate of rate of temperature niche evolution - faster rates of change = more variation in the trait = more kutosis.\n\n# first scale parameters to be in the same units\nsim_data_scaled &lt;- sim_data\nsim_data_scaled[,1:6] &lt;- scale(sim_data_scaled[,1:6] )\n\n# fit the multiple regression\nlm1  &lt;- lm(temp_kurtosis ~ divergence_threshold+lambda+omega+sigma_squared_bs+sigma_squared_t+dispersal, data=sim_data_scaled)\n\n# look at model coefficients\nsummary(lm1)\n\n\nCall:\nlm(formula = temp_kurtosis ~ divergence_threshold + lambda + \n    omega + sigma_squared_bs + sigma_squared_t + dispersal, data = sim_data_scaled)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.7214 -0.7281 -0.3103  0.2481 22.9740 \n\nCoefficients:\n                     Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           3.26301    0.04670  69.872  &lt; 2e-16 ***\ndivergence_threshold  0.48515    0.04978   9.745  &lt; 2e-16 ***\nlambda                0.22304    0.04717   4.729 2.49e-06 ***\nomega                 0.07447    0.04769   1.562    0.119    \nsigma_squared_bs      0.02415    0.04677   0.516    0.606    \nsigma_squared_t       0.29197    0.04690   6.225 6.37e-10 ***\ndispersal             0.26180    0.04915   5.326 1.17e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.737 on 1377 degrees of freedom\nMultiple R-squared:  0.1076,    Adjusted R-squared:  0.1037 \nF-statistic: 27.68 on 6 and 1377 DF,  p-value: &lt; 2.2e-16\n\n\nWhat do you see? Are our expectations met? Any surprises? Let’s try a few other biodiversity patterns where the predictions are less clear.\n\n# fit the multiple regressions\n\n# Gamma statsitic for phylogenetic tree shape\nlm2  &lt;- lm(gamma ~ divergence_threshold+lambda+omega+sigma_squared_bs+sigma_squared_t+dispersal, data=sim_data_scaled)\n\n# skewness of the range size distribution of species\nlm3  &lt;- lm(rs_skewness ~ divergence_threshold+lambda+omega+sigma_squared_bs+sigma_squared_t+dispersal, data=sim_data_scaled)\n\n# correlation between species range sizes and temperature\nlm4  &lt;- lm(rangesize_temp_cor ~ divergence_threshold+lambda+omega+sigma_squared_bs+sigma_squared_t+dispersal, data=sim_data_scaled)\n\n# look at model coefficients\nsummary(lm2)\n\n\nCall:\nlm(formula = gamma ~ divergence_threshold + lambda + omega + \n    sigma_squared_bs + sigma_squared_t + dispersal, data = sim_data_scaled)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-14.6901  -3.3262  -0.3125   3.0625  19.1039 \n\nCoefficients:\n                     Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           1.58975    0.13209  12.035  &lt; 2e-16 ***\ndivergence_threshold -1.67245    0.14081 -11.877  &lt; 2e-16 ***\nlambda               -0.36850    0.13341  -2.762  0.00582 ** \nomega                 1.13745    0.13489   8.432  &lt; 2e-16 ***\nsigma_squared_bs      0.04682    0.13230   0.354  0.72347    \nsigma_squared_t      -0.17454    0.13266  -1.316  0.18848    \ndispersal             0.99940    0.13903   7.188 1.07e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.914 on 1377 degrees of freedom\nMultiple R-squared:  0.2175,    Adjusted R-squared:  0.2141 \nF-statistic: 63.78 on 6 and 1377 DF,  p-value: &lt; 2.2e-16\n\nsummary(lm3)\n\n\nCall:\nlm(formula = rs_skewness ~ divergence_threshold + lambda + omega + \n    sigma_squared_bs + sigma_squared_t + dispersal, data = sim_data_scaled)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-5.5219 -1.7186 -0.2771  1.3923 21.2181 \n\nCoefficients:\n                     Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           6.14631    0.06701  91.717  &lt; 2e-16 ***\ndivergence_threshold -2.11448    0.07144 -29.598  &lt; 2e-16 ***\nlambda               -0.60219    0.06768  -8.897  &lt; 2e-16 ***\nomega                -0.31157    0.06844  -4.553 5.76e-06 ***\nsigma_squared_bs      0.22387    0.06712   3.335 0.000875 ***\nsigma_squared_t      -0.57043    0.06730  -8.476  &lt; 2e-16 ***\ndispersal            -1.33498    0.07053 -18.927  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.493 on 1377 degrees of freedom\nMultiple R-squared:  0.4552,    Adjusted R-squared:  0.4528 \nF-statistic: 191.8 on 6 and 1377 DF,  p-value: &lt; 2.2e-16\n\nsummary(lm4)\n\n\nCall:\nlm(formula = rangesize_temp_cor ~ divergence_threshold + lambda + \n    omega + sigma_squared_bs + sigma_squared_t + dispersal, data = sim_data_scaled)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.72559 -0.08895  0.01488  0.09329  0.68488 \n\nCoefficients:\n                      Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           0.197748   0.004238  46.658  &lt; 2e-16 ***\ndivergence_threshold -0.029361   0.004518  -6.498 1.13e-10 ***\nlambda               -0.022882   0.004281  -5.345 1.05e-07 ***\nomega                -0.042760   0.004328  -9.879  &lt; 2e-16 ***\nsigma_squared_bs     -0.001199   0.004245  -0.283    0.778    \nsigma_squared_t       0.041124   0.004256   9.662  &lt; 2e-16 ***\ndispersal            -0.019362   0.004461  -4.340 1.53e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1577 on 1377 degrees of freedom\nMultiple R-squared:  0.1388,    Adjusted R-squared:  0.135 \nF-statistic: 36.99 on 6 and 1377 DF,  p-value: &lt; 2.2e-16\n\n\nIn all these cases there are interesting associations between model parameters and the biodiversity metrics. However, look at the R-squared values and what do you find? They are highly variable and in some cases quite low. This means that lots of variance in these biodiversity metrics are not explained by a linear combination of our model parameters. This is important when interpreting the effect. There are other ways of inferring more complex relationships between model parameters and biodiversity metrics, such as by including quadratic effects, exploring interaction terms, fitting non-linear models such as generalised additive models (GAMs), or even using machine learning methods such as neural networks which allow for highly-dimension non-linear effects. We won’t cover these today but they are all useful options to explore during sensitivity analysis.\n\n4.0.1 Model Selection\nOnce we have established that some biodiversity metrics showed predictable relationships with model parameters or the generative model (e.g., M0-M4) we can use these metrics to perform model selection on empirical data. Here we are using the match between observed biodiversity patterns and simulated biodiversity patterns, to ask which model might be most likely to have generated the real patterns.\n\n\n\nSkeels et al. 2022 Syst. Biol. Figure 2\n\n\nTo do this we are going to perform a linear discriminant analysis which is a classification tool that can fit fit fairly quickly compared to some of the other models. We want to validate how well the model performs so we will perform a 10-fold cross validation repeated 10 times. Here we train the model on a subset of the data, repeating the process and optimising the predictive capacity. Then we predict how good a job our classifier is on a witheld portion of the data (test data). If the model performs well we should be able to accurately predict what models generated what biodiversity metrics.\n\nrequire(caret)\n# get just the biodiversity metrics\nsim_data_ms &lt;- sim_data[,7:ncol(sim_data)]\n\n# remove MRDs variables from sim data\nsim_data_ms &lt;- sim_data_ms[, -which(grepl(\"MRDs\",colnames(sim_data_ms)))]\n\n# partition into a training and testing dataset for cross validation\ntrain_index &lt;- createDataPartition(sim_data_ms$m, p = .66, list = FALSE,  times = 1)\ntrain_data &lt;- sim_data_ms[ train_index ,]\ntest_data  &lt;- sim_data_ms[-train_index ,]\n\n# preprocess values - we will scale and center values\npreprocessed_values &lt;- preProcess(train_data, method = c(\"center\", \"scale\"))\ntrain_transformed   &lt;- predict(preprocessed_values, train_data)\ntest_transformed    &lt;- predict(preprocessed_values, test_data )\n\n# configure the cross-validation paramaters\ntrain_control &lt;- trainControl( method = \"repeatedcv\", number = 10, repeats = 10, classProbs = TRUE, savePredictions = TRUE)\n\n# FIT MODELS\nf1 &lt;- formula(paste(\"m ~ \", paste(names(sim_data_ms)[2:c(length(names(sim_data_ms)))], collapse=\" + \")))\n\n## LINEAR DISCRIMINANT ANALYSIS\n# note we'll run an LDA because they're quick - many other kinds of models to choose from \nlda_train        &lt;- train(f1, data=train_transformed, method = \"lda\", trControl = train_control, verbose = T)\n\n#predict on test data\nlda_test        &lt;- predict(lda_train, test_transformed)\n\n# classification accuracy\nlda_cm        &lt;- confusionMatrix(data = lda_test, reference = as.factor(test_transformed$m), mode = \"prec_recall\")\n\n# how well did the model perform\nlda_cm \n\nConfusion Matrix and Statistics\n\n          Reference\nPrediction  m0  m1  m2  m3\n        m0 110  15   5  13\n        m1   4  95   1   4\n        m2   0   0  83  27\n        m3   3   6  28  73\n\nOverall Statistics\n                                          \n               Accuracy : 0.773           \n                 95% CI : (0.7323, 0.8102)\n    No Information Rate : 0.2505          \n    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       \n                                          \n                  Kappa : 0.6973          \n                                          \n Mcnemar's Test P-Value : 0.004102        \n\nStatistics by Class:\n\n                     Class: m0 Class: m1 Class: m2 Class: m3\nPrecision               0.7692    0.9135    0.7545    0.6636\nRecall                  0.9402    0.8190    0.7094    0.6239\nF1                      0.8462    0.8636    0.7313    0.6432\nPrevalence              0.2505    0.2484    0.2505    0.2505\nDetection Rate          0.2355    0.2034    0.1777    0.1563\nDetection Prevalence    0.3062    0.2227    0.2355    0.2355\nBalanced Accuracy       0.9229    0.8967    0.8161    0.7591\n\n\nWhats the overall accuracy? Are some models predicted better than others?\nNow we’ll use this model to predict the possible model of diversification in orders of terrestrial vertebrates.\n\n# first subset and clean the colnames of the empirical data\nempirical_data &lt;- read.csv(\"data/order_empirical_summary_statistics.csv\")\n\n# just want to look at diverse clades\nempirical_data &lt;- na.omit(empirical_data[which(empirical_data$n_species &gt;= 20),])\n\n# make labels lower case\nempirical_data$taxon &lt;- tolower(empirical_data$taxon)\n\n# clean up a few names because I'm a grub\ncolnames(empirical_data)[which(colnames(empirical_data) == \"taxon\")] &lt;- \"m\"\ncolnames(empirical_data)[which(colnames(empirical_data)==\"rs_kutosis\")] &lt;- \"rs_kurtosis\"\ncolnames(empirical_data)[which(colnames(empirical_data)==\"n_species\")] &lt;- \"n_extant_diversity\"\ncolnames(empirical_data) &lt;- gsub(\"_p_cor\", \"_cor\",colnames(empirical_data)) # change _p_cor for posterior samplescould also change _m_cor to use MCC samples\ncolnames(empirical_data) &lt;- gsub(\"DivRate\", \"DR\",colnames(empirical_data))\ncolnames(empirical_data)[which(colnames(empirical_data) == \"taxon\")] &lt;- \"m\"\ncolnames(empirical_data)[which(colnames(empirical_data) == \"collessI_posterior\")] &lt;- \"collessI\"\ncolnames(empirical_data)[which(colnames(empirical_data) == \"sackinI_mcc\")] &lt;- \"sackinI\"\ncolnames(empirical_data)[which(colnames(empirical_data) == \"gamma_mcc\")] &lt;- \"gamma\"\n\n\n# ok these should be able to be matched now\nempirical_data &lt;- empirical_data[, which(colnames(empirical_data) %in% colnames(sim_data_ms))]\nempirical_subset &lt;- empirical_data[, match(colnames(sim_data_ms), colnames(empirical_data))]\n\n# check names match\ncolnames(sim_data_ms)[which(!colnames(sim_data_ms) %in% colnames(empirical_subset))]\n\ncharacter(0)\n\ncolnames(empirical_subset)[which(!colnames(empirical_subset) %in% colnames(sim_data_ms))]\n\ncharacter(0)\n\ncolnames(empirical_subset) == colnames(sim_data_ms)\n\n [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[16] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[31] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n\n# Process empirical data in the same way as for the simulated data\nsimulated_transformed &lt;- predict(preprocessed_values, sim_data_ms )\nempirical_transformed &lt;- predict(preprocessed_values, empirical_subset )\n\nmodel_set &lt;- list(lda_train)\n\n# predict on empirical\nclass_predictions   &lt;- predict(model_set, newdata = empirical_transformed, type = \"raw\", na.action = na.omit)\nclass_probabilities &lt;- predict(model_set, newdata = empirical_transformed, type = \"prob\", na.action = na.omit)\n\n# sum the classes\ncolSums(do.call(rbind, class_predictions)) # TODO define class prediction table\n\n [1] 1 2 1 2 1 1 4 1 3 3 1 4 2 3 1 4 2 4 3 2 1 1 3 2 1 1 2 2 4 3 2 1 4 4 3 4 1 2\n[39] 1 4 1 3 4 3 4 2 4 1\n\n# now we can see which model is the most supported for each order\ncbind(empirical_transformed$m, as.character(class_predictions[[1]]))\n\n      [,1]                [,2]\n [1,] \"serpentes\"         \"m0\"\n [2,] \"anguimorpha\"       \"m1\"\n [3,] \"dibamia\"           \"m0\"\n [4,] \"gekkota\"           \"m1\"\n [5,] \"iguania\"           \"m0\"\n [6,] \"lacertoidea\"       \"m0\"\n [7,] \"scincoidea\"        \"m3\"\n [8,] \"afrosoricida\"      \"m0\"\n [9,] \"carnivora\"         \"m2\"\n[10,] \"cetartiodactyla\"   \"m2\"\n[11,] \"chiroptera\"        \"m0\"\n[12,] \"cingulata\"         \"m3\"\n[13,] \"dasyuromorphia\"    \"m1\"\n[14,] \"didelphimorphia\"   \"m2\"\n[15,] \"diprotodontia\"     \"m0\"\n[16,] \"eulipotyphla\"      \"m3\"\n[17,] \"lagomorpha\"        \"m1\"\n[18,] \"primates\"          \"m3\"\n[19,] \"rodentia\"          \"m2\"\n[20,] \"scandentia\"        \"m1\"\n[21,] \"accipitriformes\"   \"m0\"\n[22,] \"anseriformes\"      \"m0\"\n[23,] \"apodiformes\"       \"m2\"\n[24,] \"bucerotiformes\"    \"m1\"\n[25,] \"caprimulgiformes\"  \"m0\"\n[26,] \"charadriiformes\"   \"m0\"\n[27,] \"columbiformes\"     \"m1\"\n[28,] \"coraciiformes\"     \"m1\"\n[29,] \"cuculiformes\"      \"m3\"\n[30,] \"falconiformes\"     \"m2\"\n[31,] \"galliformes\"       \"m1\"\n[32,] \"gruiformes\"        \"m0\"\n[33,] \"musophagiformes\"   \"m3\"\n[34,] \"otidiformes\"       \"m3\"\n[35,] \"passeriformes\"     \"m2\"\n[36,] \"pelecaniformes\"    \"m3\"\n[37,] \"piciformes\"        \"m0\"\n[38,] \"procellariiformes\" \"m1\"\n[39,] \"psittaciformes\"    \"m0\"\n[40,] \"strigiformes\"      \"m3\"\n[41,] \"suliformes\"        \"m0\"\n[42,] \"tinamiformes\"      \"m2\"\n[43,] \"trogoniformes\"     \"m3\"\n[44,] \"anura\"             \"m2\"\n[45,] \"caudata\"           \"m3\"\n[46,] \"gymnophiona\"       \"m1\"\n[47,] \"crocodylia\"        \"m3\"\n[48,] \"testudines\"        \"m0\"\n\ntable(class_predictions[[1]])\n\n\nm0 m1 m2 m3 \n16 11  9 12 \n\n# can also look at the variation in this\ncbind(empirical_transformed$m, round(class_probabilities[[1]], 3))\n\n   empirical_transformed$m    m0    m1    m2    m3\n1                serpentes 0.517 0.000 0.483 0.000\n2              anguimorpha 0.000 0.598 0.000 0.402\n3                  dibamia 1.000 0.000 0.000 0.000\n4                  gekkota 0.000 0.999 0.000 0.001\n5                  iguania 1.000 0.000 0.000 0.000\n6              lacertoidea 1.000 0.000 0.000 0.000\n7               scincoidea 0.000 0.000 0.000 1.000\n8             afrosoricida 1.000 0.000 0.000 0.000\n9                carnivora 0.000 0.000 1.000 0.000\n10         cetartiodactyla 0.041 0.000 0.959 0.000\n11              chiroptera 0.828 0.000 0.172 0.000\n12               cingulata 0.000 0.000 0.000 1.000\n13          dasyuromorphia 0.000 1.000 0.000 0.000\n15         didelphimorphia 0.000 0.000 1.000 0.000\n16           diprotodontia 1.000 0.000 0.000 0.000\n17            eulipotyphla 0.000 0.000 0.000 1.000\n19              lagomorpha 0.000 1.000 0.000 0.000\n28                primates 0.000 0.000 0.000 1.000\n30                rodentia 0.002 0.000 0.998 0.000\n31              scandentia 0.012 0.988 0.000 0.000\n33         accipitriformes 1.000 0.000 0.000 0.000\n34            anseriformes 1.000 0.000 0.000 0.000\n35             apodiformes 0.000 0.000 1.000 0.000\n37          bucerotiformes 0.000 1.000 0.000 0.000\n38        caprimulgiformes 1.000 0.000 0.000 0.000\n41         charadriiformes 0.979 0.021 0.000 0.000\n44           columbiformes 0.000 0.965 0.000 0.035\n45           coraciiformes 0.000 0.664 0.000 0.336\n46            cuculiformes 0.000 0.000 0.000 1.000\n48           falconiformes 0.147 0.000 0.853 0.000\n49             galliformes 0.000 0.983 0.000 0.017\n51              gruiformes 1.000 0.000 0.000 0.000\n53         musophagiformes 0.000 0.000 0.000 1.000\n54             otidiformes 0.000 0.000 0.000 1.000\n55           passeriformes 0.001 0.000 0.995 0.004\n56          pelecaniformes 0.000 0.000 0.291 0.709\n59              piciformes 0.998 0.000 0.001 0.000\n61       procellariiformes 0.000 1.000 0.000 0.000\n62          psittaciformes 0.767 0.233 0.000 0.000\n66            strigiformes 0.000 0.000 0.000 1.000\n67              suliformes 1.000 0.000 0.000 0.000\n68            tinamiformes 0.000 0.000 0.981 0.019\n69           trogoniformes 0.000 0.000 0.000 1.000\n70                   anura 0.001 0.000 0.885 0.114\n71                 caudata 0.000 0.000 0.000 1.000\n72             gymnophiona 0.000 1.000 0.000 0.000\n73              crocodylia 0.000 0.134 0.000 0.866\n74              testudines 1.000 0.000 0.000 0.000\n\n\nWhat patterns do you see? Which models are the most supported?",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>🖥️ Silicodiversity</span>"
    ]
  },
  {
    "objectID": "Day3_Prac6_sandbox.html",
    "href": "Day3_Prac6_sandbox.html",
    "title": "6  🥪 Sandbox",
    "section": "",
    "text": "The aim for this practical is to try and take what you’ve learned about how Gen3sis works and attempt to elaborate on the configs you have been already playing with. As a case study, and because there’s so many ways it could be possible to implement, we think it would be fun to try and implement different ways to test the Ecological Limits Hypothesis (ELH) in small groups.\n\n\n\n\n\n\nNote\n\n\n\nIf you have a particular hypothesis or case study you’d like to work on instead, let us know and we might be able to tailor this.\n\n\nThe day will be quite free-form and we’ll be around to guide you, but a straight forward way to do this would be to:\n\nTake an existing landscape you have used already, such as South America or the simulated islands\nTake an existing config from day 1 (M1-M4)\nModify the existing config, probably in the ecology function, to implement the ELH\nRun the simulation, troubleshooting any errors you get along the way\nPlot out some key biodiversity patterns (like richness) and explore how they differ to the original config\n\nOf course, you don’t have to do the basic version of this prac, you might want to make more dramatic changes, such as by:\n\nUsing different landscapes - either simulating them following Day 2’s landscape modification prac, or from empirical data such as paleoenvironmenta data from Tristan’s work, marine data from OBIS, future climate projections under climate change (CHELSA), or climate from the last glacial maximum (LGM; CHELSA)\nCreating the whole config, or parts of it, from scratch. For example you may want to implement different models of trait evolution, or include different traits, different dispersal functions etc. You are not limited to the configs we have provided!",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>🥪 Sandbox</span>"
    ]
  },
  {
    "objectID": "Day1_Prac1_setup.html",
    "href": "Day1_Prac1_setup.html",
    "title": "1  🍍 Gettin’ Started",
    "section": "",
    "text": "Download workshop files Github Repository\nFirst thing is to download all of the data needed from github and set up our workspace.\nThis will make sure all the paths in the code are relative to the root, and things should work like magic.\nNow you should be able to follow along, copying the code from this Quarto document into your console. The alternative option is to open the RProject file “CBA_Gen3sis_Workshop_2024.Rproj” and work directly within this project.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>🍍 Gettin' Started</span>"
    ]
  },
  {
    "objectID": "Day2_Prac4_outputs.html",
    "href": "Day2_Prac4_outputs.html",
    "title": "4  🖥️ Silicodiversity",
    "section": "",
    "text": "Exploring outputs\nIn this practical we will explore the outputs from gen3sis using the island simulations we ran yesterday. We will learn how to use this data with common R packages for phylogenetic comparative methods, community phylogenetics, biogeography and much more.\nThe goal for today will be to produce:\nFirst, let’s make sure we have the necessary packages loaded\nrequire(gen3sis)\nrequire(terra)\nrequire(ape)\nrequire(phytools)\nrequire(picante)\nrequire(here)\nsetwd(here())",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>🖥️ Silicodiversity</span>"
    ]
  }
]